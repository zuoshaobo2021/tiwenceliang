ESP8266 + TMP117 + 巴法云 体温计：硬件与代码全解析

设计目标
打造一枚纽扣大小 的体温计，300mAh电池续航30-45天，每5分钟自动上传体温到巴法云，数据格式为#36.5#

硬件设计详解
1. 核心器件选型
• ESP8266-12F：16×24mm，板载天线，Wi-Fi直连
• TMP117：2×2mm WSON封装，±0.1℃精度，I²C接口
• 300mAh锂聚合物电池：厚度仅4mm，可弯曲贴合外壳
• XC6206-3.3V LDO：超低静态电流1μA，效率高达90%
2. 电路连接图
所有元件可焊接在20×30mm双面PCB上，采用0402封装实现极致小型化：

ESP8266-12F    TMP117    电池
3V3    ---->   VCC       (通过LDO)
GND    ---->   GND       (电池负极)
GPIO5  ---->   SCL       (I²C时钟)
GPIO4  ---->   SDA       (I²C数据)
GPIO16 <----   ALERT     (中断唤醒)
EN     ---->   100nF电容 (上电延时)


3. 关键设计要点
• 天线布局：ESP8266天线区域下方禁止铺铜，保持5mm净空
• 电源去耦：TMP117 VCC引脚旁放置100nF+1μF陶瓷电容
• 温度传导：TMP117底部裸露焊盘直接焊接金属外壳
• 低功耗开关：GPIO16控制MOSFET切断传感器供电


功耗计算与优化
续航时间计算
深度睡眠电流：
20 μA
唤醒工作电流：
80 mA × 3秒
平均电流：
0.25 mA
理论续航：
300mAh ÷ 0.25mA = 1200小时 ≈ 50天
PCB布局建议

4层板叠层设计：
• 顶层：元件面，TMP117居中，ESP8266靠边
• 内层1：GND完整平面，天线下方挖空
• 内层2：3.3V电源平面，分割供电区域
• 底层：电池焊盘，编程接口

关键尺寸：
• 整体尺寸：20×30×4mm（含电池）
• 天线净空：5×10mm区域禁止铺铜
• 温度传导：TMP117底部直接焊接金属外壳
